From 0f4f8659129ad06a7680de01011b3d7487f72274 Mon Sep 17 00:00:00 2001
From: Kaan Alsan <alsan@google.com>
Date: Wed, 21 Jan 2026 17:12:50 -0800
Subject: [PATCH] Rename TabSlotShimView to VerticalTabSlotView

Change-Id: I8bde1db1f80c1e0693e61ac20188805d9bddec15
Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/7499976
Reviewed-by: Eshwar Stalin <estalin@chromium.org>
Commit-Queue: Kaan Alsan <alsan@chromium.org>
Cr-Commit-Position: refs/heads/main@{#1572664}
---

--- a/chrome/browser/ui/views/tabs/vertical/vertical_tab_drag_handler.cc
+++ b/chrome/browser/ui/views/tabs/vertical/vertical_tab_drag_handler.cc
@@ -32,17 +32,17 @@ namespace {
 // tab dragging logic in `TabDragController`. Longer term, core tab dragging
 // logic will be updated to remove the `TabSlotView` dependency, which
 // should make this shim view no longer needed.
-class TabSlotShimView : public TabSlotView {
-  METADATA_HEADER(TabSlotShimView, TabSlotView)
+class VerticalTabSlotView : public TabSlotView {
+  METADATA_HEADER(VerticalTabSlotView, TabSlotView)
  public:
-  explicit TabSlotShimView(const TabCollectionNode& node) : node_(node) {
+  explicit VerticalTabSlotView(const TabCollectionNode& node) : node_(node) {
     // TODO(crbug.com/439963720): Support dragging other types.
     CHECK(node_->type() == TabCollectionNode::Type::TAB);
   }
 
-  ~TabSlotShimView() override = default;
-  TabSlotShimView(const TabSlotShimView&) = delete;
-  TabSlotShimView& operator=(const TabSlotShimView&) = delete;
+  ~VerticalTabSlotView() override = default;
+  VerticalTabSlotView(const VerticalTabSlotView&) = delete;
+  VerticalTabSlotView& operator=(const VerticalTabSlotView&) = delete;
 
   TabSlotView::ViewType GetTabSlotViewType() const override {
     return ViewType::kTab;
@@ -56,7 +56,7 @@ class TabSlotShimView : public TabSlotVi
   const raw_ref<const TabCollectionNode> node_;
 };
 
-BEGIN_METADATA(TabSlotShimView)
+BEGIN_METADATA(VerticalTabSlotView)
 END_METADATA
 
 ui::mojom::DragEventSource EventSourceFromEvent(const ui::LocatedEvent& event) {
@@ -94,11 +94,11 @@ void VerticalTabDragHandlerImpl::Initial
     TabCollectionNode* selected_node =
         root_node_->GetNodeForHandle(tab->GetHandle());
     CHECK(selected_node);
-    auto* shim_view = &GetOrCreateShimViewForNode(*selected_node);
-    shim_view->SetBoundsRect(selected_node->view()->GetLocalBounds());
-    dragged_views[next_dragged_view_idx++] = shim_view;
+    auto* slot_view = &GetOrCreateSlotViewForNode(*selected_node);
+    slot_view->SetBoundsRect(selected_node->view()->GetLocalBounds());
+    dragged_views[next_dragged_view_idx++] = slot_view;
     if (selected_node == &node) {
-      source_dragged_view = shim_view;
+      source_dragged_view = slot_view;
     }
   }
   CHECK(source_dragged_view);
@@ -277,10 +277,10 @@ bool VerticalTabDragHandlerImpl::IsViewD
 
 views::View* VerticalTabDragHandlerImpl::ViewFromTabSlot(
     TabSlotView* view) const {
-  auto* shim_view = views::AsViewClass<TabSlotShimView>(view);
-  CHECK(shim_view);
+  auto* slot_view = views::AsViewClass<VerticalTabSlotView>(view);
+  CHECK(slot_view);
 
-  const TabCollectionNode& node = shim_view->node();
+  const TabCollectionNode& node = slot_view->node();
 
   // If the dragged tab view is in a split, return the split's tab view
   // instead.
@@ -326,17 +326,17 @@ TabDragContext* VerticalTabDragHandlerIm
 TabSlotView* VerticalTabDragHandlerImpl::GetTabForContents(
     content::WebContents* contents) {
   TabCollectionNode* node = GetNodeForContents(contents);
-  return node ? &GetOrCreateShimViewForNode(*node) : nullptr;
+  return node ? &GetOrCreateSlotViewForNode(*node) : nullptr;
 }
 
 content::WebContents* VerticalTabDragHandlerImpl::GetContentsForTab(
     TabSlotView* view) {
-  auto* shim_view = views::AsViewClass<TabSlotShimView>(view);
-  CHECK(shim_view);
+  auto* slot_view = views::AsViewClass<VerticalTabSlotView>(view);
+  CHECK(slot_view);
   // TODO(crbug.com/439963720): Support dragging other types.
-  CHECK(shim_view->node().type() == TabCollectionNode::Type::TAB);
+  CHECK(slot_view->node().type() == TabCollectionNode::Type::TAB);
   const tabs::TabInterface* tab =
-      std::get<const tabs::TabInterface*>(shim_view->node().GetNodeData());
+      std::get<const tabs::TabInterface*>(slot_view->node().GetNodeData());
   CHECK(tab);
   return tab->GetContents();
 }
@@ -382,10 +382,10 @@ void VerticalTabDragHandlerImpl::Destroy
 void VerticalTabDragHandlerImpl::StartedDragging(
     const std::vector<TabSlotView*>& views) {
   for (auto* view : views) {
-    auto* shim_view = views::AsViewClass<TabSlotShimView>(view);
-    CHECK(shim_view);
+    auto* slot_view = views::AsViewClass<VerticalTabSlotView>(view);
+    CHECK(slot_view);
 
-    views::View* dragged_view = ViewFromTabSlot(shim_view);
+    views::View* dragged_view = ViewFromTabSlot(slot_view);
     CHECK(dragged_view);
     dragged_view->SetPaintToLayer();
     dragged_view->layer()->SetFillsBoundsOpaquely(false);
@@ -393,17 +393,17 @@ void VerticalTabDragHandlerImpl::Started
     // Update the height to use preferred size because newly added tabs will
     // animate in from 0, which affects the window offset for newly-detached
     // windows.
-    gfx::Rect bounds = shim_view->node().view()->GetLocalBounds();
-    bounds.set_height(shim_view->node().view()->GetPreferredSize({}).height());
-    shim_view->SetBoundsRect(bounds);
+    gfx::Rect bounds = slot_view->node().view()->GetLocalBounds();
+    bounds.set_height(slot_view->node().view()->GetPreferredSize({}).height());
+    slot_view->SetBoundsRect(bounds);
   }
 }
 
 void VerticalTabDragHandlerImpl::DraggedTabsDetached() {}
 
 void VerticalTabDragHandlerImpl::StoppedDragging() {
-  for (auto& [_, shim_view] : shim_views_) {
-    views::View* dragged_view = ViewFromTabSlot(shim_view);
+  for (auto& [_, slot_view] : slot_views_) {
+    views::View* dragged_view = ViewFromTabSlot(slot_view);
     CHECK(dragged_view);
     dragged_view->DestroyLayer();
   }
@@ -426,31 +426,31 @@ TabCollectionNode* VerticalTabDragHandle
   return root_node_->GetNodeForHandle(tab->GetHandle());
 }
 
-TabSlotView& VerticalTabDragHandlerImpl::GetOrCreateShimViewForNode(
+TabSlotView& VerticalTabDragHandlerImpl::GetOrCreateSlotViewForNode(
     TabCollectionNode& node) {
   CHECK(node.view());
-  auto it = shim_views_.find(&node);
-  if (it != shim_views_.end()) {
+  auto it = slot_views_.find(&node);
+  if (it != slot_views_.end()) {
     return *it->second;
   }
 
-  auto tab_shim_view = std::make_unique<TabSlotShimView>(node);
-  tab_shim_view->SetBoundsRect(node.view()->GetLocalBounds());
-  auto& tab_shim_view_ref = *tab_shim_view.get();
-  shim_views_.insert(
-      {&node, node.view()->AddChildView(std::move(tab_shim_view))});
+  auto tab_slot_view = std::make_unique<VerticalTabSlotView>(node);
+  tab_slot_view->SetBoundsRect(node.view()->GetLocalBounds());
+  auto& tab_slot_view_ref = *tab_slot_view.get();
+  slot_views_.insert(
+      {&node, node.view()->AddChildView(std::move(tab_slot_view))});
   node_destroyed_callbacks_.push_back(node.RegisterWillDestroyCallback(
       base::BindOnce(&VerticalTabDragHandlerImpl::OnNodeWillDestroy,
                      base::Unretained(this), std::ref(node))));
-  tab_shim_view_ref.SetVisible(false);
-  return tab_shim_view_ref;
+  tab_slot_view_ref.SetVisible(false);
+  return tab_slot_view_ref;
 }
 
 void VerticalTabDragHandlerImpl::OnNodeWillDestroy(TabCollectionNode& node) {
-  auto it = shim_views_.find(&node);
-  CHECK(it != shim_views_.end());
+  auto it = slot_views_.find(&node);
+  CHECK(it != slot_views_.end());
   auto view = node.view()->RemoveChildViewT(it->second);
-  shim_views_.erase(it);
+  slot_views_.erase(it);
 }
 
 void VerticalTabDragHandlerImpl::ResetDragState() {
--- a/chrome/browser/ui/views/tabs/vertical/vertical_tab_drag_handler.h
+++ b/chrome/browser/ui/views/tabs/vertical/vertical_tab_drag_handler.h
@@ -106,9 +106,9 @@ class VerticalTabDragHandlerImpl : publi
  private:
   TabCollectionNode* GetNodeForContents(content::WebContents* contents);
 
-  // Creates a `TabSlotView` shim for `node`, used for compatibility with the
-  // core dragging system. The created shim view is cached in `shim_views_`.
-  TabSlotView& GetOrCreateShimViewForNode(TabCollectionNode& node);
+  // Creates a `TabSlotView` for `node`, used for compatibility with the
+  // core dragging system. The created slot view is cached in `slot_views_`.
+  TabSlotView& GetOrCreateSlotViewForNode(TabCollectionNode& node);
 
   // Resets member variables that track a drag being managed by this handler.
   void ResetDragState();
@@ -128,9 +128,9 @@ class VerticalTabDragHandlerImpl : publi
   // Null if this handler is not managing a dragging session.
   std::unique_ptr<TabDragController> drag_controller_ = nullptr;
 
-  // A mapping from nodes to their `TabSlotView` shims, used for compatibility
+  // A mapping from nodes to their `TabSlotView`, used for compatibility
   // with the core dragging system.
-  std::map<raw_ptr<const TabCollectionNode>, raw_ptr<TabSlotView>> shim_views_;
+  std::map<raw_ptr<const TabCollectionNode>, raw_ptr<TabSlotView>> slot_views_;
   std::vector<base::CallbackListSubscription> node_destroyed_callbacks_;
 };
 
