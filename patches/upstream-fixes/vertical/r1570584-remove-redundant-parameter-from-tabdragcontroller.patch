From ea293fc0af60e2911bb7a7f88aa216fd22170904 Mon Sep 17 00:00:00 2001
From: Kaan Alsan <alsan@chromium.org>
Date: Fri, 16 Jan 2026 12:26:16 -0800
Subject: [PATCH] Remove redundant parameter from TabDragController::Init

The `offset_from_first_dragged_view` parameter is removed because it's
not used in a meaningful way. The existing `offset_from_source`
parameter supersedes it.

Bug: 476084253
Change-Id: Ia2606c350e2e5310db65c2bc3b7a806bd1df9ceb
Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/7485877
Reviewed-by: Eshwar Stalin <estalin@chromium.org>
Commit-Queue: Kaan Alsan <alsan@chromium.org>
Cr-Commit-Position: refs/heads/main@{#1570584}
---

--- a/chrome/browser/ui/views/tabs/dragging/tab_drag_controller.cc
+++ b/chrome/browser/ui/views/tabs/dragging/tab_drag_controller.cc
@@ -372,7 +372,6 @@ TabDragController::Liveness TabDragContr
     TabDragContext* source_context,
     TabSlotView* source_view,
     const std::vector<TabSlotView*>& dragging_views,
-    const gfx::Point& offset_from_first_dragged_view,
     const gfx::Point& offset_from_source_view,
     ui::ListSelectionModel initial_selection_model,
     ui::mojom::DragEventSource event_source) {
@@ -406,10 +405,8 @@ TabDragController::Liveness TabDragContr
 #if BUILDFLAG(IS_LINUX) || BUILDFLAG(IS_CHROMEOS)
   ref->can_release_capture_ = false;
 #endif
-  ref->start_point_in_screen_ = gfx::Point(offset_from_source_view.x(),
-                                           offset_from_first_dragged_view.y());
-  views::View::ConvertPointToScreen(source_view,
-                                    &(ref->start_point_in_screen_));
+  ref->start_point_in_screen_ =
+      views::View::ConvertPointToScreen(source_view, offset_from_source_view);
   ref->event_source_ = event_source;
   ref->last_point_in_screen_ = start_point_in_screen_;
   // Detachable tabs are not supported on Mac if the window is an out-of-process
--- a/chrome/browser/ui/views/tabs/dragging/tab_drag_controller.h
+++ b/chrome/browser/ui/views/tabs/dragging/tab_drag_controller.h
@@ -127,8 +127,7 @@ class TabDragController : public views::
   // Initializes TabDragController to drag the views in `dragging_views`
   // originating from `source_context`. `source_view` is the view that
   // initiated the drag and is either a Tab or a TabGroupHeader contained in
-  // `dragging_views`. `offset_from_first_dragged_view` is the distance of the
-  // mouse pointer from the origin of the first view in `dragging_views` and
+  // `dragging_views`.
   // `offset_from_source_view` the offset from `source_view`.
   // `initial_selection_model` is the selection model before the drag started
   // and is only non-empty if the original selection isn't the same as the
@@ -137,7 +136,6 @@ class TabDragController : public views::
   [[nodiscard]] Liveness Init(TabDragContext* source_context,
                               TabSlotView* source_view,
                               const std::vector<TabSlotView*>& dragging_views,
-                              const gfx::Point& offset_from_first_dragged_view,
                               const gfx::Point& offset_from_source_view,
                               ui::ListSelectionModel initial_selection_model,
                               ui::mojom::DragEventSource event_source);
--- a/chrome/browser/ui/views/tabs/tab_strip.cc
+++ b/chrome/browser/ui/views/tabs/tab_strip.cc
@@ -270,8 +270,6 @@ class TabStrip::TabDragContextImpl : pub
                       const ui::LocatedEvent& event,
                       ui::ListSelectionModel original_selection) {
     std::vector<TabSlotView*> dragging_views;
-    int x = source->GetMirroredXInView(event.x());
-    int y = event.y();
 
     // Build the set of selected tabs to drag and calculate the offset from the
     // source.
@@ -317,9 +315,6 @@ class TabStrip::TabDragContextImpl : pub
         }
 
         dragging_views.push_back(other_tab);
-        if (other_tab == source) {
-          x += GetSizeNeededForViews(dragging_views) - other_tab->width();
-        }
       }
       if (!original_selection.IsSelected(
               tab_strip_->GetModelIndexOf(source).value())) {
@@ -349,8 +344,8 @@ class TabStrip::TabDragContextImpl : pub
     // TabStrip, and the TabDragController, and may end the drag and destroy
     // `tab_drag_controller_`. If Init returns DELETED, then `drag_controller_`
     // is nullptr or it points to a *different instance*.
-    if (drag_controller_->Init(this, source, dragging_views, gfx::Point(x, y),
-                               event.location(), std::move(selection_model),
+    if (drag_controller_->Init(this, source, dragging_views, event.location(),
+                               std::move(selection_model),
                                EventSourceFromEvent(event)) ==
         TabDragController::Liveness::kDeleted) {
       return;
--- a/chrome/browser/ui/views/tabs/vertical/vertical_tab_drag_handler.cc
+++ b/chrome/browser/ui/views/tabs/vertical/vertical_tab_drag_handler.cc
@@ -88,15 +88,13 @@ void VerticalTabDragHandlerImpl::Initial
 
   // TODO(crbug.com/439963720): Support dragging multiple tabs.
   dragged_tabs_.insert(&node);
-  const gfx::Point offset_from_first_dragged_view = event.location();
   const gfx::Point offset_from_source = event.location();
   ui::ListSelectionModel selection_model;
   TabSlotView& dragged_view = GetOrCreateShimViewForNode(node);
   dragged_view.SetBoundsRect(node.view()->GetLocalBounds());
 
   if (drag_controller_->Init(this, &dragged_view, {&dragged_view},
-                             offset_from_first_dragged_view, offset_from_source,
-                             std::move(selection_model),
+                             offset_from_source, std::move(selection_model),
                              EventSourceFromEvent(event)) ==
       TabDragController::Liveness::kDeleted) {
     dragged_tabs_.clear();
